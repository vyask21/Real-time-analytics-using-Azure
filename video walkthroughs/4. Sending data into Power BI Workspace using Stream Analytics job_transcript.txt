Welcome back and welcome back to this task.
In this task, you will send data into Power BI workspace
to analyze data using Azure Stream Analytics job and Azure event
hubs. So let's start with the demo. First click on Home,
and the first step is to create
Event hub's name space because we will use event hubs.
So click on
Create a resource and type in Event hub, click on Event hubs
and click on Create.
Choose your resource group and for namespace name I will
choose, type in ehndsavovic.
First letter of my first name
and my last name.
You choose yours, you use yours and  for region location
choose the closest to you.
Closest to me is West Europe, pricing tier - choose Recommended,
Standard (20 Consumer groups, 1000 Brokered connections).
Throughput Units - 1, and click on Review and Create. 
Validation is running and succeeded and click on Create.
This will take it to the deployment is in progress page.
You can now pause the video and wait for deployment to finish.
Deployment is complete.
Now go to Resource and see that there are zero event hubs
in this namespace.
So create new event hub, give it a name ehtelemetry.
You can use the same. Leave all options to default and
click Create.
Event Hub has created.
Now we have one
event hub.
You can see this here.
Okay, now go to Home and navigate to the IoT hub
you created a few tasks ago.
Click on IoT hubs.
If you don't have it here, type in here IoT, click on IoT hub.
You should see all the IoT hubs that you have created.
I have only one, click on it and go to messaging and click on
message routing to create a route for telemetry data. Click on
Add, give it a name. The name will be telemetryroute
For Endpoint click at Add endpoint and click
event hubs, for endpoint name choose, type in telemetryendpoint
and choose an existing event hub you've just created.
For me it's ehndsavovic, and event hub instance is ehtelemetry.
Click Create to create event hub endpoint named
telemetryendpoint. Okay, this will take some time.
So pause the video until it's finished.
Okay, adding an endpoint has finished.
Now we have the endpoint here. For data source
make sure it's device telemetry messages, enable route
enabled and for routing query
delete this true value.
Go to Windows Explorer and open route telemetry.txt,
select all, and copy.
Go back to browser and paste.
So we are routing only messages that for key sensor id have
value VSTell. These are telemetry messages.
Click Save.
Okay. You can pause the video until the message routing
is created.
Message routing is created.
We have now two routes, one for long messages and one for
telemetry messages.
We're just configuring. Now go back to home.
Go to your Stream Analytics job.
You can find it under recent resources, if it is not there,
then click on the Search resources box and type in Stream.
Click on Stream Analytics jobs and you will get all the jobs you
have. Mine is sajdeansavovic.
Okay, we'll now add new input.
So click on Inputs. Add new stream input and choose
event hub.
Input alias will be telemetry input, so type in telemetry input.
We will select event hub from your subscription.
I have only one, so it is already selected.
I have only one event hub name, so it's already selected.
Event hub
consumer group should be: use existing default.
Authentication mode should be connection
string instead of managed identity and choose
Use existing, and choose route manage shared access key.
Partition key leave blank and all other options leave under
defaults.
And click on Save.
Okay, the input has been added.
Now it's in testing phase.
Let's see how that goes.
So it's testing and it's successful.
Close the notification window and go to outputs of this job
to create the Power BI output.
Click on Add and choose Power BI, click Unauthorized and type
in your Power BI account, email or phone. Then input
your password. After you have inputted the password, 
click on Sign in, click on No, and now
you have authorized Stream Analytics job to access the
Power BI workspace.
I'll put alias for output.
Alias type telemetry output.
Group workspaces if you have more workspaces on Power BI
account, I don't.
I have only one. For dataset name type in telemetry
and for table name type in telemetry.
This is the name of the dataset down on the table in the
workspace
that will be created. For authentication mode make
sure it's User token selected, and click on Save.
So we're now adding and testing the output, still testing and
it's successful.
Closing notification window and go to queries.
Now go to Windows Explorer and double click Stream Analytics telemetry
query. Select both queries with CTRL+A, right click and
copy. Go to browser, go to this query we previously created,
delete it, and paste. Click on Save.
We have saved the settings.
Now go to overview and start job. Click on Start.
Okay, in this task you created event hub instance and
routed messages from IoT device to event hub.
Then you created a Stream Analytics job to send data into Power
BI workspace.
In the next task, we will create a Power BI dashboard using
the data set created from the Stream Analytics job.
See you in the next task.